<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>即将开始</title>
    <style type="text/css">
        .timer-notice{
            background-color: white;
            color: black;
            margin-top: 10px;
            width: 81px;
            height: 50px;
            border-radius: 10px;
            font-size: 20px;
        }
    </style>
</head>
<body>

    <h1>即将开始</h1>
    <table border="1" cellpadding="5">
        <tr>
            <th>比赛</th>
            <th>正方</th>
            <th>反方</th>
            <th>是否开始</th>
            <th>30s 提示音</th>
            <th>15s 提示音</th>
        </tr>
        {{range .}}
            <tr>
                <td>{{.Name}}</td>
                <td>{{.Positive}}</td>
                <td>{{.Negative}}</td>
                <td><button class="start-btn" match-id="{{.Id}}">开始</button></td>
                <td><button id="set-30s-timer" class="timer-notice">播放</button></td>
                <td><button id="set-15s-timer" class="timer-notice">播放</button></td>
            </tr>
        {{end}}
    </table>
    <script>
            var buttons = document.getElementsByClassName("start-btn");
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].addEventListener("click", function() {
                    var id = this.getAttribute("match-id");
                    window.location.href = "/start?id=" + encodeURIComponent(id);
                });
            }
            var playButton30 = document.getElementById("set-30s-timer");
            var audio30 = new Audio("http://localhost:9090/audio/30s.wav");
            playButton30.addEventListener("click", function() {
                audio30.play().then(function() {
                    setTimeout(function() {
                        audio30.play();
                    }, audio30.duration * 1000);
                });
            });

            var playButton15 = document.getElementById("set-15s-timer");
            var audio15 = new Audio("http://localhost:9090/audio/15s.wav");
            playButton15.addEventListener("click", function() {
                audio15.play().then(function() {
                    setTimeout(function() {
                        audio15.play();
                    }, audio15.duration * 1000);
                });
            });

    </script>
</body>
</html>